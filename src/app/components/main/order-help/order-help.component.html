<app-nav>
  <div left-content>
    <a (click)="back()" class="text-decoration-none text-dark">
      <i
        class="fas fa-arrow-left me-2"
        style="font-size: 1.5em; color: var(--primary)"
      ></i>
    </a>
  </div>
  <div central-content>
    <h3 class="title-page m-0">Ajuda</h3>
  </div>
  <div right-content>
    <!-- <i
      class="fas fa-question-circle"
      style="font-size: 1.5em; color: var(--primary)"
      title="Clique para mais informações"
      (click)="openModal()"
    ></i> -->
  </div>
</app-nav>
<section
  style="margin-bottom: 6em; margin-top: 1em"
  class="max-w-4xl mx-auto lg:px-8"
>
  <div class="container mt-4 pt-2" *ngFor="let c of card">
    <div class="text-center mb-6">
      <i class="fas fa-headset text-4xl text-blue-500 mb-3"></i>
      <h2 class="text-2xl font-bold">Como podemos ajudar?</h2>
      <p class="mt-2">Descreva detalhadamente o problema encontrado</p>
    </div>
    <div class="rounded-xl shadow-sm space-y-4 p-6">
      <div class="p-1 mb-6">
        <div class="card-body">
          <p class="card-text">
            <strong>Número do Pedido:</strong> #{{ c.id_pedido }}
          </p>
          <p class="card-text">
            <strong>Solicitado em:</strong>
            {{ c.createdAt | date : "dd/MM/yyyy - HH:mm" }}
          </p>
          <br />
          <p class="card-text"><strong>Serviço:</strong> {{ c.categoria }}</p>
          <p class="card-text">
            <strong>Tipo de problema:</strong>
            {{ questionTitle }}
          </p>
        </div>
      </div>

      <!-- Formulário -->
      <div>
        <label
          class="block text-sm font-medium mb-2"
          style="color: var(--secondary) !important"
        >
          Descreva o problema *
        </label>
        <textarea
          [(ngModel)]="message"
          placeholder="Ex: O prestador chegou atrasado e não trouxe todos os materiais necessários..."
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
          rows="6"
          maxlength="500"
          minlength="40"
        ></textarea>
        <div class="text-sm mt-1" style="color: var(--secondary)">
          {{ message.length }}/500 caracteres (mínimo 40)
        </div>
      </div>

      <!-- Botões de ação -->
      <div class="flex flex-col sm:flex-row gap-3 pt-4">
        <!-- WhatsApp -->
        <button
          *ngIf="questionTitle !== 'cancelar'"
          (click)="enviarWhatsApp()"
          [disabled]="!message || message.length < 40"
          class="flex-1 flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white font-medium py-3 px-4 rounded-lg transition-colors"
        >
          <i class="fab fa-whatsapp"></i>
          Enviar por WhatsApp
        </button>
        <button
          *ngIf="questionTitle === 'cancelar'"
          (click)="cancelar()"
          [disabled]="!message || message.length < 40"
          class="flex-1 flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white font-medium py-3 px-4 rounded-lg transition-colors"
        >
          <span *ngIf="!loadingBtn">
            {{
              isProfessional ? "Cancelar candidatura" : "Cancelar pedido"
            }}</span
          >
          <span *ngIf="loadingBtn" class="flex items-center justify-center">
            <i class="fas fa-circle-notch fa-spin mr-2"></i>
            Cancelando...
          </span>
        </button>

        <!-- Email -->
        <!-- <button
          (click)="enviarEmail()"
          [disabled]="!message"
          class="flex-1 flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors"
        >
          <i class="fas fa-envelope"></i>
          Enviar por Email
        </button> -->
      </div>

      <!-- Aviso -->
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4">
        <div class="flex items-start gap-3">
          <i class="fas fa-info-circle text-yellow-500 mt-1"></i>
          <div>
            <p class="text-sm font-medium" style="color: #854d0e !important">
              Importante
            </p>
            <p
              class="text-sm mt-1"
              style="color: #a16207 !important"
              *ngIf="questionTitle !== 'cancelar'"
            >
              Nossa equipe entrará em contato em até 24 horas úteis.
            </p>
            <p
              class="text-sm mt-1"
              style="color: #a16207 !important"
              *ngIf="questionTitle === 'cancelar'"
            >
              O valor estornado será lançado automaticamente em sua fatura de
              acordo com os prazos estabelecidos pela operadora do cartão.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- <button
      style="
        color: var(--primary);
        secondary-color: var(--light) !important;
        border: 1px solid var(--primary);
      "
      class="request-quote-btn col-12"
      (click)="cancelarPedido()"
    >
      Cancelar pedido
    </button> -->
  </div>
  <!-- Modal  -->
  <app-custom-modal
    #meuModal
    (click)="closeCancelationModal()"
  ></app-custom-modal>

  <!-- <button
          (click)="cancelPayment()"
          [disabled]="!message || message.length < 40"
          class="flex-1 flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white font-medium py-3 px-4 rounded-lg transition-colors"
        >
         Cancelar teste
        </button> -->
</section>
