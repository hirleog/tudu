<app-nav>
  <div left-content>
    <div left-content class="d-flex align-items-center">
      <a
        [routerLink]="['/']"
        class="text-decoration-none text-dark d-flex align-items-center"
      >
        <i class="fas fa-arrow-left pr-4"></i>
      </a>
    </div>
  </div>
  <div central-content>
    <a routerLink="/" class="logo">
      <img
        [routerLink]="[isProfessional ? '/tudu-professional/home' : '/home']"
        [src]="
          isProfessional
            ? '../../../assets/logo-roxoo.webp'
            : '../../../assets/logo-branco.webp'
        "
        class="img-fluid"
        style="width: 4em"
        alt="error"
      />
    </a>
  </div>
  <div right-content></div>
</app-nav>

<section id="login" class="d-flex justify-content-center mt-5">
  <div class="row container d-flex justify-content-center">
    <div class="col-md-8">
      <div class="card shadow" style="height: auto">
        <div class="card-header text-center">
          <ul class="nav nav-tabs card-header-tabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                [ngClass]="{ 'active-tab': selectedTab === 'login' }"
                (click)="selectTab('login')"
                type="button"
              >
                Login
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                [ngClass]="{ 'active-tab': selectedTab === 'register' }"
                (click)="selectTab('register')"
                type="button"
              >
                Cadastro
              </button>
            </li>
          </ul>
        </div>
        <div class="card-body">
          <!-- Login Form -->
          <div *ngIf="selectedTab === 'login'">
            <h4 class="text-center mb-3">Bem-vindo de volta!</h4>
            <p class="text-center mb-4 text-muted">
              {{
                isProfessional === true
                  ? "Faça login para continuar prestando serviço."
                  : "Faça login para solicitar novos serviços."
              }}
            </p>
            <form [formGroup]="loginForm" (ngSubmit)="onLogin()">
              <div class="mb-3">
                <label for="loginEmail" class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="loginEmail"
                  formControlName="email"
                  placeholder="Digite seu email"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="loginPassword" class="form-label">Senha</label>
                <input
                  type="password"
                  class="form-control"
                  id="loginPassword"
                  formControlName="password"
                  placeholder="Digite sua senha"
                  required
                />
                <div *ngIf="loginErrorMessage" class="text-danger mt-1">
                  {{ errorMessage }}
                </div>
              </div>
              <div class="text-center mt-3">
                <a
                  [routerLink]="['/login/password-reset']"
                  [queryParams]="{
                    type: isProfessional ? 'prestadores' : 'clientes'
                  }"
                  class="text-decoration-none"
                >
                  Esqueci minha senha
                </a>
              </div>

              <button
                [disabled]="loginForm.invalid"
                type="submit"
                class="col-12 btn btn-primary mt-3"
                style="color: white"
              >
                <span *ngIf="!isLoadingBtn" style="color: white !important"
                  ><i
                    class="fas fa-paper-plane"
                    style="color: white !important"
                  ></i>
                  Entrar</span
                >
                <span
                  *ngIf="isLoadingBtn"
                  class="flex items-center justify-center"
                >
                  <i
                    class="fas fa-circle-notch fa-spin mr-2"
                    style="color: white"
                  ></i>
                  Carregando...
                </span>
              </button>
            </form>
          </div>

          <!-- Register Form -->
          <div *ngIf="selectedTab === 'register'">
            <h4 class="text-center mb-3">Crie sua Conta</h4>
            <p class="text-center mb-4 text-muted">
              {{
                isProfessional === true
                  ? "Cadastre-se para começar a oferecer seus serviços."
                  : "Cadastre-se para solicitar serviços."
              }}
            </p>
            <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
              <div class="mb-3">
                <label for="registerName" class="form-label">Nome</label>
                <input
                  type="text"
                  class="form-control"
                  id="registerName"
                  formControlName="nome"
                  placeholder="Digite seu nome"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="registerLastName" class="form-label"
                  >Sobrenome</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="registerLastName"
                  formControlName="sobrenome"
                  placeholder="Digite seu sobrenome"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="registerPhone" class="form-label">Telefone</label>
                <input
                  type="text"
                  class="form-control"
                  id="registerPhone"
                  formControlName="telefone"
                  placeholder="Digite seu telefone"
                  required
                />
              </div>
              <!-- <div class="mb-3">
                <label for="registerCpf" class="form-label">CPF</label>
                <input
                  type="text"
                  class="form-control"
                  id="registerCpf"
                  formControlName="cpf"
                  placeholder="Digite seu CPF"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="registerBirthDate" class="form-label"
                  >Data de Nascimento</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="registerBirthDate"
                  formControlName="data_nascimento"
                  required
                />
              </div> -->
              <div class="mb-3">
                <label for="registerEmail" class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="registerEmail"
                  formControlName="email"
                  placeholder="Digite seu email"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="registerPassword" class="form-label">Senha</label>
                <input
                  type="password"
                  class="form-control"
                  id="registerPassword"
                  formControlName="password"
                  placeholder="Digite sua senha"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="confirmPassword" class="form-label"
                  >Confirmar Senha</label
                >
                <input
                  type="password"
                  class="form-control"
                  id="confirmPassword"
                  formControlName="confirmPassword"
                  placeholder="Confirme sua senha"
                  required
                />
                <div
                  *ngIf="
                    registerForm.get('confirmPassword')?.touched &&
                    registerForm.get('confirmPassword')?.hasError('mismatch')
                  "
                  class="text-danger"
                >
                  As senhas não coincidem.
                </div>
              </div>

              <button
                type="submit"
                style="color: white"
                class="col-12 btn btn-primary"
              >
                <span *ngIf="!isLoadingBtn"
                  ><i
                    class="fas fa-paper-plane"
                    style="color: white !important"
                  ></i>
                  Cadastrar</span
                >
                <span
                  *ngIf="isLoadingBtn"
                  class="flex items-center justify-center"
                >
                  <i class="fas fa-circle-notch fa-spin mr-2"></i>
                  Carregando...
                </span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- modais -->

  <app-custom-modal #meuModal (click)="goToLogin()"></app-custom-modal>
</section>
